{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "title": {"text": "2014", "align": "center", "baseline": "bottom", "fontSize": 15, "dy": 117, "fontWeight":600},
  "data": {"url": "https://ryan-khoo.github.io/assignment2/male_female_pie.csv"},

  "width": 100, "height": 100,

  "transform": [
    {
      "aggregate": [{"op":"sum","field":"cases", "as": "sum_cases"}],
      "groupby":["year", "sex"]
    },
    {"filter": "datum.year == 2014"}
  ],

  "mark": {"type": "arc", "innerRadius": 90},

  "encoding": {
    "theta": {"field": "sum_cases", "type":"quantitative"},
    "color": {
      "field": "sex", 
      "type":"nominal",
      "legend": null,
      "scale": {"range": ["#ffb3b3", "#99bbff"]}
    },
    "tooltip": [
      {"field": "sex", "type": "nominal"},
      {"field": "sum_cases", "type": "quantitative", "title": "Total cases"}
    ]
  },
  "view": {"stroke": null}

}